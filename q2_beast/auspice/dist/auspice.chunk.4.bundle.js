(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{543:function(t,e,n){"use strict";var a=n(548);e.a=function(){for(var t,e=a.c;t=e.sourceEvent;)e=t;return e}},544:function(t,e,n){"use strict";e.a=function(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var a=n.createSVGPoint();return a.x=e.clientX,a.y=e.clientY,[(a=a.matrixTransform(t.getScreenCTM().inverse())).x,a.y]}var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}},558:function(t,e,n){var a=n(559);"string"==typeof a&&(a=[[t.i,a,""]]);n(40)(a,{});a.locals&&(t.exports=a.locals)},559:function(t,e,n){(t.exports=n(39)(!1)).push([t.i,'\n/* Variables - keep in sync with globalStyles.js*/\n:root {\n  --darkGrey: #333;\n  --medGrey: #888;\n}\n\n#d3entropy .overlay {\n  fill: none;\n  pointer-events: all;\n}\n\n#d3entropy .brush {\n  stroke: none;\n}\n\n#d3entropy .niceText {\n  font-family: "Lato", "Helvetica Neue", "Helvetica", "sans-serif";\n  font-size: 14px;\n  font-style: italic;\n  color: var(--medGrey);\n}\n\n.brush .selection {\n  cursor: grab;\n  cursor: -moz-grab;\n  cursor: -webkit-grab;\n}\n',""])},560:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return f}));var a=Array.prototype.slice,o=function(t){return t};function i(t){return"translate("+(t+.5)+",0)"}function s(t){return"translate(0,"+(t+.5)+")"}function r(t){return function(e){return+t(e)}}function c(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(n){return+t(n)+e}}function l(){return!this.__axis}function h(t,e){var n=[],h=null,u=null,f=6,p=6,d=3,m=1===t||4===t?-1:1,y=4===t||2===t?"x":"y",v=1===t||3===t?i:s;function x(a){var i=null==h?e.ticks?e.ticks.apply(e,n):e.domain():h,s=null==u?e.tickFormat?e.tickFormat.apply(e,n):o:u,x=Math.max(f,0)+d,g=e.range(),b=+g[0]+.5,M=+g[g.length-1]+.5,w=(e.bandwidth?c:r)(e.copy()),k=a.selection?a.selection():a,_=k.selectAll(".domain").data([null]),z=k.selectAll(".tick").data(i,e).order(),N=z.exit(),O=z.enter().append("g").attr("class","tick"),j=z.select("line"),C=z.select("text");_=_.merge(_.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),z=z.merge(O),j=j.merge(O.append("line").attr("stroke","currentColor").attr(y+"2",m*f)),C=C.merge(O.append("text").attr("fill","currentColor").attr(y,m*x).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),a!==k&&(_=_.transition(a),z=z.transition(a),j=j.transition(a),C=C.transition(a),N=N.transition(a).attr("opacity",1e-6).attr("transform",(function(t){return isFinite(t=w(t))?v(t):this.getAttribute("transform")})),O.attr("opacity",1e-6).attr("transform",(function(t){var e=this.parentNode.__axis;return v(e&&isFinite(e=e(t))?e:w(t))}))),N.remove(),_.attr("d",4===t||2==t?p?"M"+m*p+","+b+"H0.5V"+M+"H"+m*p:"M0.5,"+b+"V"+M:p?"M"+b+","+m*p+"V0.5H"+M+"V"+m*p:"M"+b+",0.5H"+M),z.attr("opacity",1).attr("transform",(function(t){return v(w(t))})),j.attr(y+"2",m*f),C.attr(y,m*x).text(s),k.filter(l).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),k.each((function(){this.__axis=w}))}return x.scale=function(t){return arguments.length?(e=t,x):e},x.ticks=function(){return n=a.call(arguments),x},x.tickArguments=function(t){return arguments.length?(n=null==t?[]:a.call(t),x):n.slice()},x.tickValues=function(t){return arguments.length?(h=null==t?null:a.call(t),x):h&&h.slice()},x.tickFormat=function(t){return arguments.length?(u=t,x):u},x.tickSize=function(t){return arguments.length?(f=p=+t,x):f},x.tickSizeInner=function(t){return arguments.length?(f=+t,x):f},x.tickSizeOuter=function(t){return arguments.length?(p=+t,x):p},x.tickPadding=function(t){return arguments.length?(d=+t,x):d},x}function u(t){return h(3,t)}function f(t){return h(4,t)}},749:function(t,e,n){"use strict";var a=n(543),o=n(544);e.a=function(t){var e=Object(a.a)();return e.changedTouches&&(e=e.changedTouches[0]),Object(o.a)(t,e)}},758:function(t,e,n){"use strict";n.r(e);var a=n(59),o=n.n(a),i=n(60),s=n.n(i),r=n(82),c=n.n(r),l=n(83),h=n.n(l),u=n(53),f=n.n(u),p=n(16),d=n.n(p),m=n(3),y=n.n(m),v=n(15),x=n.n(v),g=n(46),b=n(754),M=n(161),w=n(529),k=n(531),_=n(549),z=n(526),N=n(548),O=n(30),j=n(560),C=n(523),T=n(753);var S=function(){N.c.preventDefault(),N.c.stopImmediatePropagation()},B=function(t){var e=t.document.documentElement,n=Object(b.a)(t).on("dragstart.drag",S,!0);"onselectstart"in e?n.on("selectstart.drag",S,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")};function E(t,e){var n=t.document.documentElement,a=Object(b.a)(t).on("dragstart.drag",null);e&&(a.on("click.drag",S,!0),setTimeout((function(){a.on("click.drag",null)}),0)),"onselectstart"in n?a.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var A=Math.SQRT2;function G(t){return((t=Math.exp(t))+1/t)/2}var P=function(t,e){var n,a,o=t[0],i=t[1],s=t[2],r=e[0],c=e[1],l=e[2],h=r-o,u=c-i,f=h*h+u*u;if(f<1e-12)a=Math.log(l/s)/A,n=function(t){return[o+t*h,i+t*u,s*Math.exp(A*t*a)]};else{var p=Math.sqrt(f),d=(l*l-s*s+4*f)/(2*s*2*p),m=(l*l-s*s-4*f)/(2*l*2*p),y=Math.log(Math.sqrt(d*d+1)-d),v=Math.log(Math.sqrt(m*m+1)-m);a=(v-y)/A,n=function(t){var e,n=t*a,r=G(y),c=s/(2*p)*(r*(e=A*n+y,((e=Math.exp(2*e))-1)/(e+1))-function(t){return((t=Math.exp(t))-1/t)/2}(y));return[o+c*h,i+c*u,s*r/G(A*n+y)]}}return n.duration=1e3*a,n},V=n(749),Y=n(543),L=n(544),D=function(t,e,n){arguments.length<3&&(n=e,e=Object(Y.a)().changedTouches);for(var a,o=0,i=e?e.length:0;o<i;++o)if((a=e[o]).identifier===n)return Object(L.a)(t,a);return null},R=function(t){return function(){return t}};function H(t,e,n){this.target=t,this.type=e,this.transform=n}function I(t,e,n){this.k=t,this.x=e,this.y=n}I.prototype={constructor:I,scale:function(t){return 1===t?this:new I(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new I(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var F=new I(1,0,0);function X(){N.c.stopImmediatePropagation()}I.prototype;var Z=function(){N.c.preventDefault(),N.c.stopImmediatePropagation()};function q(){return!N.c.ctrlKey&&!N.c.button}function K(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function U(){return this.__zoom||F}function W(){return-N.c.deltaY*(1===N.c.deltaMode?.05:N.c.deltaMode?1:.002)}function J(){return navigator.maxTouchPoints||"ontouchstart"in this}function Q(t,e,n){var a=t.invertX(e[0][0])-n[0][0],o=t.invertX(e[1][0])-n[1][0],i=t.invertY(e[0][1])-n[0][1],s=t.invertY(e[1][1])-n[1][1];return t.translate(o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}var $=n(524),tt=function(t){return function(){return t}},et=function(t,e,n){this.target=t,this.type=e,this.selection=n};function nt(){N.c.stopImmediatePropagation()}var at=function(){N.c.preventDefault(),N.c.stopImmediatePropagation()},ot={name:"drag"},it={name:"space"},st={name:"handle"},rt={name:"center"};function ct(t){return[+t[0],+t[1]]}function lt(t){return[ct(t[0]),ct(t[1])]}function ht(t){return function(e){return D(e,N.c.touches,t)}}var ut={name:"x",handles:["w","e"].map(xt),input:function(t,e){return null==t?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},ft={name:"y",handles:["n","s"].map(xt),input:function(t,e){return null==t?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},pt=(["n","w","e","s","nw","ne","sw","se"].map(xt),{overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"}),dt={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},mt={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},yt={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},vt={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function xt(t){return{type:t}}function gt(){return!N.c.ctrlKey&&!N.c.button}function bt(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function Mt(){return navigator.maxTouchPoints||"ontouchstart"in this}function wt(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function kt(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function _t(t){var e,n=bt,a=gt,o=Mt,i=!0,s=Object(T.a)("start","brush","end"),r=6;function c(e){var n=e.property("__brush",m).selectAll(".overlay").data([xt("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",pt.overlay).merge(n).each((function(){var t=wt(this).extent;Object(b.a)(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])})),e.selectAll(".selection").data([xt("selection")]).enter().append("rect").attr("class","selection").attr("cursor",pt.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var a=e.selectAll(".handle").data(t.handles,(function(t){return t.type}));a.exit().remove(),a.enter().append("rect").attr("class",(function(t){return"handle handle--"+t.type})).attr("cursor",(function(t){return pt[t.type]})),e.each(l).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",f).filter(o).on("touchstart.brush",f).on("touchmove.brush",p).on("touchend.brush touchcancel.brush",d).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function l(){var t=Object(b.a)(this),e=wt(this).selection;e?(t.selectAll(".selection").style("display",null).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1]),t.selectAll(".handle").style("display",null).attr("x",(function(t){return"e"===t.type[t.type.length-1]?e[1][0]-r/2:e[0][0]-r/2})).attr("y",(function(t){return"s"===t.type[0]?e[1][1]-r/2:e[0][1]-r/2})).attr("width",(function(t){return"n"===t.type||"s"===t.type?e[1][0]-e[0][0]+r:r})).attr("height",(function(t){return"e"===t.type||"w"===t.type?e[1][1]-e[0][1]+r:r}))):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function h(t,e,n){return!n&&t.__brush.emitter||new u(t,e)}function u(t,e){this.that=t,this.args=e,this.state=t.__brush,this.active=0}function f(){if((!e||N.c.touches)&&a.apply(this,arguments)){var n,o,s,r,c,u,f,p,d,m,y,v=this,x=N.c.target.__data__.type,g="selection"===(i&&N.c.metaKey?x="overlay":x)?ot:i&&N.c.altKey?rt:st,M=t===ft?null:yt[x],k=t===ut?null:vt[x],_=wt(v),z=_.extent,O=_.selection,j=z[0][0],C=z[0][1],T=z[1][0],S=z[1][1],A=0,G=0,P=M&&k&&i&&N.c.shiftKey,Y=N.c.touches?ht(N.c.changedTouches[0].identifier):V.a,L=Y(v),D=L,R=h(v,arguments,!0).beforestart();"overlay"===x?(O&&(d=!0),_.selection=O=[[n=t===ft?j:L[0],s=t===ut?C:L[1]],[c=t===ft?T:n,f=t===ut?S:s]]):(n=O[0][0],s=O[0][1],c=O[1][0],f=O[1][1]),o=n,r=s,u=c,p=f;var H=Object(b.a)(v).attr("pointer-events","none"),I=H.selectAll(".overlay").attr("cursor",pt[x]);if(N.c.touches)R.moved=X,R.ended=q;else{var F=Object(b.a)(N.c.view).on("mousemove.brush",X,!0).on("mouseup.brush",q,!0);i&&F.on("keydown.brush",K,!0).on("keyup.brush",U,!0),B(N.c.view)}nt(),Object(w.a)(v),l.call(v),R.start()}function X(){var t=Y(v);!P||m||y||(Math.abs(t[0]-D[0])>Math.abs(t[1]-D[1])?y=!0:m=!0),D=t,d=!0,at(),Z()}function Z(){var t;switch(A=D[0]-L[0],G=D[1]-L[1],g){case it:case ot:M&&(A=Math.max(j-n,Math.min(T-c,A)),o=n+A,u=c+A),k&&(G=Math.max(C-s,Math.min(S-f,G)),r=s+G,p=f+G);break;case st:M<0?(A=Math.max(j-n,Math.min(T-n,A)),o=n+A,u=c):M>0&&(A=Math.max(j-c,Math.min(T-c,A)),o=n,u=c+A),k<0?(G=Math.max(C-s,Math.min(S-s,G)),r=s+G,p=f):k>0&&(G=Math.max(C-f,Math.min(S-f,G)),r=s,p=f+G);break;case rt:M&&(o=Math.max(j,Math.min(T,n-A*M)),u=Math.max(j,Math.min(T,c+A*M))),k&&(r=Math.max(C,Math.min(S,s-G*k)),p=Math.max(C,Math.min(S,f+G*k)))}u<o&&(M*=-1,t=n,n=c,c=t,t=o,o=u,u=t,x in dt&&I.attr("cursor",pt[x=dt[x]])),p<r&&(k*=-1,t=s,s=f,f=t,t=r,r=p,p=t,x in mt&&I.attr("cursor",pt[x=mt[x]])),_.selection&&(O=_.selection),m&&(o=O[0][0],u=O[1][0]),y&&(r=O[0][1],p=O[1][1]),O[0][0]===o&&O[0][1]===r&&O[1][0]===u&&O[1][1]===p||(_.selection=[[o,r],[u,p]],l.call(v),R.brush())}function q(){if(nt(),N.c.touches){if(N.c.touches.length)return;e&&clearTimeout(e),e=setTimeout((function(){e=null}),500)}else E(N.c.view,d),F.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);H.attr("pointer-events","all"),I.attr("cursor",pt.overlay),_.selection&&(O=_.selection),kt(O)&&(_.selection=null,l.call(v)),R.end()}function K(){switch(N.c.keyCode){case 16:P=M&&k;break;case 18:g===st&&(M&&(c=u-A*M,n=o+A*M),k&&(f=p-G*k,s=r+G*k),g=rt,Z());break;case 32:g!==st&&g!==rt||(M<0?c=u-A:M>0&&(n=o-A),k<0?f=p-G:k>0&&(s=r-G),g=it,I.attr("cursor",pt.selection),Z());break;default:return}at()}function U(){switch(N.c.keyCode){case 16:P&&(m=y=P=!1,Z());break;case 18:g===rt&&(M<0?c=u:M>0&&(n=o),k<0?f=p:k>0&&(s=r),g=st,Z());break;case 32:g===it&&(N.c.altKey?(M&&(c=u-A*M,n=o+A*M),k&&(f=p-G*k,s=r+G*k),g=rt):(M<0?c=u:M>0&&(n=o),k<0?f=p:k>0&&(s=r),g=st),I.attr("cursor",pt[x]),Z());break;default:return}at()}}function p(){h(this,arguments).moved()}function d(){h(this,arguments).ended()}function m(){var e=this.__brush||{selection:null};return e.extent=lt(n.apply(this,arguments)),e.dim=t,e}return c.move=function(e,n){e.selection?e.on("start.brush",(function(){h(this,arguments).beforestart().start()})).on("interrupt.brush end.brush",(function(){h(this,arguments).end()})).tween("brush",(function(){var e=this,a=e.__brush,o=h(e,arguments),i=a.selection,s=t.input("function"==typeof n?n.apply(this,arguments):n,a.extent),r=Object($.a)(i,s);function c(t){a.selection=1===t&&null===s?null:r(t),l.call(e),o.brush()}return null!==i&&null!==s?c:c(1)})):e.each((function(){var e=this,a=arguments,o=e.__brush,i=t.input("function"==typeof n?n.apply(e,a):n,o.extent),s=h(e,a).beforestart();Object(w.a)(e),o.selection=null===i?null:i,l.call(e),s.start().brush().end()}))},c.clear=function(t){c.move(t,null)},u.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting?(this.starting=!1,this.emit("start")):this.emit("brush"),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(e){Object(N.a)(new et(c,e,t.output(this.state.selection)),s.apply,s,[e,this.that,this.args])}},c.extent=function(t){return arguments.length?(n="function"==typeof t?t:tt(lt(t)),c):n},c.filter=function(t){return arguments.length?(a="function"==typeof t?t:tt(!!t),c):a},c.touchable=function(t){return arguments.length?(o="function"==typeof t?t:tt(!!t),c):o},c.handleSize=function(t){return arguments.length?(r=+t,c):r},c.keyModifiers=function(t){return arguments.length?(i=!!t,c):i},c.on=function(){var t=s.on.apply(s,arguments);return t===s?c:t},c}var zt=n(547),Nt=n.n(zt),Ot=n(36),jt=n(126),Ct=n(2);function Tt(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return St(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return St(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o,i=!0,s=!1;return{s:function(){a=t[Symbol.iterator]()},n:function(){var t=a.next();return i=t.done,t},e:function(t){s=!0,o=t},f:function(){try{i||null==a.return||a.return()}finally{if(s)throw o}}}}function St(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}var Bt=function(t,e,n,a,o){this.svg=Object(b.a)(t),this.annotations=e,this.geneMap=n,this.maxNt=a,this.callbacks=o,this.okToDrawBars=!1};Bt.prototype.render=function(t){this.props=t,this.aa="aa"===t.mutType,this.bars=t.bars,this.selectedNodes=Object(Ot.d)(t.colorBy)?this._getSelectedNodes(Object(Ot.a)(t.colorBy,t.geneLength)):[],this.svg.selectAll("*").remove(),this._calcOffsets(t.width,t.height),this._drawMainNavElements(),this._addZoomLayers(),this._setScales(this.maxNt+1,t.maxYVal),this.zoomCoordinates=Object(Ot.d)(t.colorBy)?this._getZoomCoordinates(Object(Ot.a)(t.colorBy,t.geneLength),t.geneMap):this.scales.xNav.domain(),this.zoomCoordinates[0]=t.zoomMin?t.zoomMin:this.zoomCoordinates[0],this.zoomCoordinates[1]=t.zoomMax?t.zoomMax:this.zoomCoordinates[1],this._drawAxes(),this._addBrush(),this._addClipMask(),this._drawGenes(this.annotations),this._drawZoomGenes(this.annotations),this.okToDrawBars=!0,this._drawBars(),this.zoomed=this._createZoomFn()},Bt.prototype.update=function(t){var e=this,n=t.aa,a=void 0===n?void 0:n,o=t.selected,i=void 0===o?void 0:o,s=t.newBars,r=void 0===s?void 0:s,c=t.maxYVal,l=void 0===c?void 0:c,h=t.clearSelected,u=void 0!==h&&h,f=t.gene,p=void 0===f?void 0:f,d=t.start,m=void 0===d?void 0:d,y=t.end,v=void 0===y?void 0:y,x=t.zoomMax,g=void 0===x?void 0:x,b=t.zoomMin,M=void 0===b?void 0:b,w=void 0!==a&&a!==this.aa;if((r||w)&&(w&&(this.aa=a),r&&(this.bars=r),this._updateYScaleAndAxis(l),this._drawBars()),void 0!==i?(this._clearSelectedBars(),this.selectedNodes=this._getSelectedNodes(i),this._highlightSelectedBars()):u&&this._clearSelectedBars(),void 0!==p&&void 0!==m&&void 0!==v){var k=v-m,_=p===Ct.I?0:1*k;this.navGraph.select(".brush").call(this.brush.move,(function(){return[Math.max(e.scales.xNav(m-_),e.scales.xNav(0)),Math.min(e.scales.xNav(v+_),e.scales.xNav(e.scales.xNav.domain()[1]))]}))}if(void 0!==M||void 0!==g){var z=void 0===M?0:M,N=void 0===g?this.scales.xNav.domain()[1]:g;this.navGraph.select(".brush").call(this.brush.move,(function(){return[e.scales.xNav(z),e.scales.xNav(N)]}))}},Bt.prototype._aaToNtCoord=function(t,e){return"-"===this.geneMap[t].strand?this.geneMap[t].end-3*e+1:this.geneMap[t].start+3*e-2},Bt.prototype._getZoomCoordinates=function(t,e){var n=[0,this.scales.xNav.domain()[1]],a=0;if(t.aa){var o=t.gene;a=1*((n=[e[o].start,e[o].end])[1]-n[0])}else{var i=this.scales.xNav.domain()[1];if(1===t.positions.length){var s=t.positions[0],r=.05*i;n=s-r<=0?[0,s+r]:s+r>=i?[s-r,i]:[s-r,s+r]}else{var c=Math.min.apply(null,t.positions),l=Math.max.apply(null,t.positions);n=[c-.05*(l-c),l+.05*(l-c)]}}return[Math.max(n[0]-a,0),Math.min(n[1]+a,this.scales.xNav.domain()[1])]},Bt.prototype._getSelectedNodes=function(t){if(this.aa===t.aa){var e=[];if(this.aa){var n,a=[],o=Tt(t.positions);try{for(o.s();!(n=o.n()).done;){var i=n.value;a.push([t.gene,i])}}catch(t){o.e(t)}finally{o.f()}var s,r=Tt(this.bars);try{for(r.s();!(s=r.n()).done;){var c,l=s.value,h=Tt(a);try{for(h.s();!(c=h.n()).done;){var u=c.value;l.prot===u[0]&&l.codon===u[1]&&e.push(l)}}catch(t){h.e(t)}finally{h.f()}}}catch(t){r.e(t)}finally{r.f()}}else{var f,p=Tt(this.bars);try{for(p.s();!(f=p.n()).done;){var d=f.value;-1!==t.positions.indexOf(d.x)&&e.push(d)}}catch(t){p.e(t)}finally{p.f()}}return e}console.error("entropy out of sync")},Bt.prototype._drawZoomGenes=function(t){var e=this;this.geneGraph.selectAll("*").remove();var n=this.scales.xNav.domain()[1]-this.scales.xNav.domain()[0]<1e6?"white":"black",a=!!t.filter((function(t){return"-"===t.strand})).length,o=function(t){return a?"-"===t?20:0:10},i=t.filter((function(t){return t.start<e.scales.xMain.domain()[1]&&t.start>e.scales.xMain.domain()[0]||t.end>e.scales.xMain.domain()[0]&&t.end<e.scales.xMain.domain()[1]||t.start<=e.scales.xMain.domain()[0]&&t.end>=e.scales.xMain.domain()[1]})),s=function(t){return t.start>e.scales.xMain.domain()[0]?e.scales.xMain(t.start):e.offsets.x1},r=function(t){return t.end<e.scales.xMain.domain()[1]?e.scales.xMain(t.end):e.offsets.x2},c=this.geneGraph.selectAll(".gene").data(i).enter().append("g");c.append("rect").attr("class","gene").attr("x",(function(t){return s(t)})).attr("y",(function(t){return o(t.strand)})).attr("width",(function(t){return r(t)-s(t)})).attr("height",20).style("fill",(function(t){return t.fill})).style("stroke",(function(){return n})),c.append("text").attr("x",(function(t){return e.scales.xMain(t.start)+(e.scales.xMain(t.end)-e.scales.xMain(t.start))/2})).attr("y",(function(t){return o(t.strand)+5})).attr("dy",".7em").attr("text-anchor","middle").style("fill",(function(){return"white"})).text((function(t){return r(t)-s(t)>15?t.prot:""}))},Bt.prototype._drawGenes=function(t){var e=this,n=this.scales.xNav.domain()[1]-this.scales.xNav.domain()[0]<1e6?"white":"black",a=this.navGraph.selectAll(".gene").data(t).enter().append("g");a.append("rect").attr("class","gene").attr("x",(function(t){return e.scales.xNav(t.start)})).attr("y",(function(t){return t.strand,5})).attr("width",(function(t){return e.scales.xNav(t.end)-e.scales.xNav(t.start)})).attr("height",20).style("fill",(function(t){return t.fill})).style("stroke",(function(){return n})),a.append("text").attr("x",(function(t){return e.scales.xNav(t.start)+(e.scales.xNav(t.end)-e.scales.xNav(t.start))/2})).attr("y",(function(t){return t.strand,10})).attr("dy",".7em").attr("text-anchor","middle").style("fill",(function(){return"white"})).text((function(t){return function(t){return t.end<e.scales.xNav.domain()[1]?e.scales.xNav(t.end):e.offsets.x2}(t)-function(t){return t.start>e.scales.xNav.domain()[0]?e.scales.xNav(t.start):e.offsets.x1}(t)>10?t.prot:""}))},Bt.prototype._clearSelectedBars=function(){var t,e=this,n=Tt(this.selectedNodes);try{for(n.s();!(t=n.n()).done;){var a=t.value,o=this.aa?"#prot".concat(a.prot).concat(a.codon):"#nt".concat(a.x),i=this.aa?function(t){return e.geneMap[t.prot].idx%2?z.h:z.a}:function(t){return t.prot?e.geneMap[t.prot].idx%2?z.h:z.a:z.f};Object(b.a)(o).style("fill",i)}}catch(t){n.e(t)}finally{n.f()}this.selectedNodes=[]},Bt.prototype._highlightSelectedBars=function(){var t,e=Tt(this.selectedNodes);try{for(e.s();!(t=e.n()).done;){var n=t.value;if(this.aa&&!n.prot)return;var a=this.aa?"#prot".concat(n.prot).concat(n.codon):"#nt".concat(n.x),o=this.aa||n.prot?this.geneMap[n.prot].fill:"red";Object(b.a)(a).style("fill",o)}}catch(t){e.e(t)}finally{e.f()}},Bt.prototype._drawBars=function(){var t=this;if(this.okToDrawBars){this.mainGraph.selectAll("*").remove();var e,n=this.scales.xMain.domain()[1]-this.scales.xMain.domain()[0];this.aa&&(n/=3),e=this.aa?n>600?2:function(e){return t.scales.xMain(t._aaToNtCoord(e.prot,e.codon)+2.6)-t.scales.xMain(t._aaToNtCoord(e.prot,e.codon))}:n>1e3?2:n>250?3:function(e){return t.scales.xMain(e.x+.3)-t.scales.xMain(e.x-.3)};var a=this.mainGraph.append("g").attr("clip-path","url(#clip)").selectAll(".bar"),o=this.aa?function(t){return"prot"+t.prot+t.codon}:function(t){return"nt"+t.x},i=this.aa?function(e){return t.scales.xMain(t._aaToNtCoord(e.prot,e.codon)-.3)}:function(e){return t.scales.xMain(e.x-.3)},s=this.aa?function(e){return t.geneMap[e.prot].idx%2?z.h:z.a}:function(e){return e.prot?t.geneMap[e.prot].idx%2?z.h:z.a:z.f};a.data(this.bars).enter().append("rect").attr("class","bar").attr("id",o).attr("x",i).attr("y",(function(e){return t.scales.y(e.y)})).attr("width",e).attr("height",(function(e){return t.offsets.heightMain-t.scales.y(e.y)})).style("fill",s).on("mouseover",(function(e){t.callbacks.onHover(e,N.c.pageX,N.c.pageY)})).on("mouseout",(function(e){t.callbacks.onLeave(e)})).on("click",(function(e){t.callbacks.onClick(e)})).style("cursor","pointer"),this._highlightSelectedBars()}},Bt.prototype._setScales=function(t,e){this.scales={},this.scales.xMax=t,this.scales.yMax=e,this.scales.yMin=0,this.scales.xMin=0,this.scales.xMain=Object(O.a)().domain([0,t]).range([this.offsets.x1,this.offsets.x2]),this.scales.xNav=Object(O.a)().domain([0,t]).range([this.offsets.x1,this.offsets.x2]),this.scales.y=Object(O.a)().domain([this.scales.yMin,1.2*e]).range([this.offsets.y2Main,this.offsets.y1Main])},Bt.prototype._drawAxes=function(){this.axes={},this.axes.y=Object(j.b)(this.scales.y).ticks(4),this.axes.xMain=Object(j.a)(this.scales.xMain).ticks(16),this.axes.xNav=Object(j.a)(this.scales.xNav).ticks(20,",f"),this.scales.xNav.domain()[1]-this.scales.xNav.domain()[0]>1e6&&this.axes.xNav.tickFormat(Object(C.a)(".1e")),this.svg.append("g").attr("class","y axis").attr("id","entropyYAxis").attr("transform","translate("+(this.offsets.x1+15)+","+this.offsets.y1Main+")").call(this.axes.y),this.svg.append("g").attr("class","xMain axis").attr("transform","translate("+this.offsets.x1+","+this.offsets.y2Main+")").call(this.axes.xMain),this.svg.append("g").attr("class","xNav axis").attr("transform","translate("+this.offsets.x1+","+this.offsets.y2Nav+")").call(this.axes.xNav)},Bt.prototype._updateYScaleAndAxis=function(t){this.scales.y=Object(O.a)().domain([this.scales.yMin,1.2*t]).range([this.offsets.y2Main,this.offsets.y1Main]),this.axes.y=Object(j.b)(this.scales.y).ticks(4),this.svg.select("#entropyYAxis").remove(),this.svg.append("g").attr("class","y axis").attr("id","entropyYAxis").attr("transform","translate("+(this.offsets.x1+15)+","+this.offsets.y1Main+")").call(this.axes.y)},Bt.prototype._calcOffsets=function(t,e){this.offsets={x1:15,x2:t-32,y1Main:0,y1Nav:e-65,y2Main:e-130,y2Nav:e-35,y1Gene:e-107,y2Gene:e-95},this.offsets.heightMain=this.offsets.y2Main-this.offsets.y1Main,this.offsets.heightNav=this.offsets.y2Nav-this.offsets.y1Nav,this.offsets.heightGene=this.offsets.y2Gene-this.offsets.y1Gene,this.offsets.width=this.offsets.x2-this.offsets.x1},Bt.prototype._addBrush=function(){var t=this;this.brushed=function(){var t=this,e=(N.c.selection||this.scales.xNav.range()).map(this.scales.xNav.invert,this.scales.xNav);this.zoomCoordinates=e.map(Math.round),N.c.selection?this._zoom(e[0],e[1]):this.navGraph.select(".brush").call(this.brush.move,(function(){return t.zoomCoordinates=t.scales.xNav.range().map(Math.round),t.scales.xNav.range()}))},this.brushFinished=function(){this.brushed(),N.c.sourceEvent instanceof MouseEvent&&(!N.c.selection||"d3entropyParent"===N.c.sourceEvent.target.id||""===N.c.sourceEvent.target.id)?this.props.dispatch(Object(jt.b)(this.zoomCoordinates)):this.props.dispatch(Object(jt.b)([void 0,void 0]))},this._zoom=function(t,e){var n=this,a=[t,e];this.scales.xMain.domain(a),this.axes.xMain=this.axes.xMain.scale(this.scales.xMain),this.svg.select(".xMain.axis").call(this.axes.xMain),this._drawBars(),this._drawZoomGenes(this.annotations),this.brushHandle&&this.brushHandle.attr("display",null).attr("transform",(function(t,e){return"translate("+n.scales.xNav(a[e])+","+(n.offsets.heightNav+25)+")"}))},this.brush=_t(ut).extent([[this.offsets.x1,0],[this.offsets.width+20,this.offsets.heightNav-1+25]]).on("brush",(function(){t.brushed()})).on("end",(function(){t.brushFinished()})),this.gBrush=this.navGraph.append("g").attr("class","brush").attr("stroke-width",0).call(this.brush).call(this.brush.move,(function(){return t.zoomCoordinates.map(t.scales.xNav)})),this.brushHandle=this.gBrush.selectAll(".handle--custom").data([{type:"w"},{type:"e"}]).enter().append("path").attr("class","handle--custom").attr("fill",z.a).attr("cursor","ew-resize").attr("d","M0,0 0,0 -5,11 5,11 0,0 Z").attr("transform",(function(e){return"e"===e.type?"translate("+(t.scales.xNav(t.zoomCoordinates[1])-1)+","+(t.offsets.heightNav+25)+")":"translate("+(t.scales.xNav(t.zoomCoordinates[0])+1)+","+(t.offsets.heightNav+25)+")"}))},Bt.prototype._addZoomLayers=function(){var t=this,e=[[this.offsets.x1,this.offsets.y1Main],[this.offsets.width,this.offsets.y2Main]];this.zoom=function(){var t,e,n=q,a=K,o=Q,i=W,s=J,r=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],l=250,h=P,u=Object(T.a)("start","zoom","end"),f=0;function p(t){t.property("__zoom",U).on("wheel.zoom",M).on("mousedown.zoom",k).on("dblclick.zoom",_).filter(s).on("touchstart.zoom",z).on("touchmove.zoom",O).on("touchend.zoom touchcancel.zoom",j).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(t,e){return(e=Math.max(r[0],Math.min(r[1],e)))===t.k?t:new I(e,t.x,t.y)}function m(t,e,n){var a=e[0]-n[0]*t.k,o=e[1]-n[1]*t.k;return a===t.x&&o===t.y?t:new I(t.k,a,o)}function y(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function v(t,e,n){t.on("start.zoom",(function(){x(this,arguments).start()})).on("interrupt.zoom end.zoom",(function(){x(this,arguments).end()})).tween("zoom",(function(){var t=this,o=arguments,i=x(t,o),s=a.apply(t,o),r=null==n?y(s):"function"==typeof n?n.apply(t,o):n,c=Math.max(s[1][0]-s[0][0],s[1][1]-s[0][1]),l=t.__zoom,u="function"==typeof e?e.apply(t,o):e,f=h(l.invert(r).concat(c/l.k),u.invert(r).concat(c/u.k));return function(t){if(1===t)t=u;else{var e=f(t),n=c/e[2];t=new I(n,r[0]-e[0]*n,r[1]-e[1]*n)}i.zoom(null,t)}}))}function x(t,e,n){return!n&&t.__zooming||new g(t,e)}function g(t,e){this.that=t,this.args=e,this.active=0,this.extent=a.apply(t,e),this.taps=0}function M(){if(n.apply(this,arguments)){var t=x(this,arguments),e=this.__zoom,a=Math.max(r[0],Math.min(r[1],e.k*Math.pow(2,i.apply(this,arguments)))),s=Object(V.a)(this);if(t.wheel)t.mouse[0][0]===s[0]&&t.mouse[0][1]===s[1]||(t.mouse[1]=e.invert(t.mouse[0]=s)),clearTimeout(t.wheel);else{if(e.k===a)return;t.mouse=[s,e.invert(s)],Object(w.a)(this),t.start()}Z(),t.wheel=setTimeout(l,150),t.zoom("mouse",o(m(d(e,a),t.mouse[0],t.mouse[1]),t.extent,c))}function l(){t.wheel=null,t.end()}}function k(){if(!e&&n.apply(this,arguments)){var t=x(this,arguments,!0),a=Object(b.a)(N.c.view).on("mousemove.zoom",l,!0).on("mouseup.zoom",h,!0),i=Object(V.a)(this),s=N.c.clientX,r=N.c.clientY;B(N.c.view),X(),t.mouse=[i,this.__zoom.invert(i)],Object(w.a)(this),t.start()}function l(){if(Z(),!t.moved){var e=N.c.clientX-s,n=N.c.clientY-r;t.moved=e*e+n*n>f}t.zoom("mouse",o(m(t.that.__zoom,t.mouse[0]=Object(V.a)(t.that),t.mouse[1]),t.extent,c))}function h(){a.on("mousemove.zoom mouseup.zoom",null),E(N.c.view,t.moved),Z(),t.end()}}function _(){if(n.apply(this,arguments)){var t=this.__zoom,e=Object(V.a)(this),i=t.invert(e),s=t.k*(N.c.shiftKey?.5:2),r=o(m(d(t,s),e,i),a.apply(this,arguments),c);Z(),l>0?Object(b.a)(this).transition().duration(l).call(v,r,e):Object(b.a)(this).call(p.transform,r)}}function z(){if(n.apply(this,arguments)){var e,a,o,i,s=N.c.touches,r=s.length,c=x(this,arguments,N.c.changedTouches.length===r);for(X(),a=0;a<r;++a)o=s[a],i=[i=D(this,s,o.identifier),this.__zoom.invert(i),o.identifier],c.touch0?c.touch1||c.touch0[2]===i[2]||(c.touch1=i,c.taps=0):(c.touch0=i,e=!0,c.taps=1+!!t);t&&(t=clearTimeout(t)),e&&(c.taps<2&&(t=setTimeout((function(){t=null}),500)),Object(w.a)(this),c.start())}}function O(){if(this.__zooming){var e,n,a,i,s=x(this,arguments),r=N.c.changedTouches,l=r.length;for(Z(),t&&(t=clearTimeout(t)),s.taps=0,e=0;e<l;++e)n=r[e],a=D(this,r,n.identifier),s.touch0&&s.touch0[2]===n.identifier?s.touch0[0]=a:s.touch1&&s.touch1[2]===n.identifier&&(s.touch1[0]=a);if(n=s.that.__zoom,s.touch1){var h=s.touch0[0],u=s.touch0[1],f=s.touch1[0],p=s.touch1[1],y=(y=f[0]-h[0])*y+(y=f[1]-h[1])*y,v=(v=p[0]-u[0])*v+(v=p[1]-u[1])*v;n=d(n,Math.sqrt(y/v)),a=[(h[0]+f[0])/2,(h[1]+f[1])/2],i=[(u[0]+p[0])/2,(u[1]+p[1])/2]}else{if(!s.touch0)return;a=s.touch0[0],i=s.touch0[1]}s.zoom("touch",o(m(n,a,i),s.extent,c))}}function j(){if(this.__zooming){var t,n,a=x(this,arguments),o=N.c.changedTouches,i=o.length;for(X(),e&&clearTimeout(e),e=setTimeout((function(){e=null}),500),t=0;t<i;++t)n=o[t],a.touch0&&a.touch0[2]===n.identifier?delete a.touch0:a.touch1&&a.touch1[2]===n.identifier&&delete a.touch1;if(a.touch1&&!a.touch0&&(a.touch0=a.touch1,delete a.touch1),a.touch0)a.touch0[1]=this.__zoom.invert(a.touch0[0]);else if(a.end(),2===a.taps){var s=Object(b.a)(this).on("dblclick.zoom");s&&s.apply(this,arguments)}}}return p.transform=function(t,e,n){var a=t.selection?t.selection():t;a.property("__zoom",U),t!==a?v(t,e,n):a.interrupt().each((function(){x(this,arguments).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()}))},p.scaleBy=function(t,e,n){p.scaleTo(t,(function(){var t=this.__zoom.k,n="function"==typeof e?e.apply(this,arguments):e;return t*n}),n)},p.scaleTo=function(t,e,n){p.transform(t,(function(){var t=a.apply(this,arguments),i=this.__zoom,s=null==n?y(t):"function"==typeof n?n.apply(this,arguments):n,r=i.invert(s),l="function"==typeof e?e.apply(this,arguments):e;return o(m(d(i,l),s,r),t,c)}),n)},p.translateBy=function(t,e,n){p.transform(t,(function(){return o(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),a.apply(this,arguments),c)}))},p.translateTo=function(t,e,n,i){p.transform(t,(function(){var t=a.apply(this,arguments),s=this.__zoom,r=null==i?y(t):"function"==typeof i?i.apply(this,arguments):i;return o(F.translate(r[0],r[1]).scale(s.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof n?-n.apply(this,arguments):-n),t,c)}),i)},g.prototype={start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){Object(N.a)(new H(p,t,this.that.__zoom),u.apply,u,[t,this.that,this.args])}},p.wheelDelta=function(t){return arguments.length?(i="function"==typeof t?t:R(+t),p):i},p.filter=function(t){return arguments.length?(n="function"==typeof t?t:R(!!t),p):n},p.touchable=function(t){return arguments.length?(s="function"==typeof t?t:R(!!t),p):s},p.extent=function(t){return arguments.length?(a="function"==typeof t?t:R([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),p):a},p.scaleExtent=function(t){return arguments.length?(r[0]=+t[0],r[1]=+t[1],p):[r[0],r[1]]},p.translateExtent=function(t){return arguments.length?(c[0][0]=+t[0][0],c[1][0]=+t[1][0],c[0][1]=+t[0][1],c[1][1]=+t[1][1],p):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},p.constrain=function(t){return arguments.length?(o=t,p):o},p.duration=function(t){return arguments.length?(l=+t,p):l},p.interpolate=function(t){return arguments.length?(h=t,p):h},p.on=function(){var t=u.on.apply(u,arguments);return t===u?p:t},p.clickDistance=function(t){return arguments.length?(f=(t=+t)*t,p):Math.sqrt(f)},p}().translateExtent(e).extent(e).on("zoom",(function(){return t.zoomed()}));var n=["option","shift"];Nt.a.bind(n,(function(){t.svg.append("rect").attr("class","overlay").attr("text","zoom").attr("transform","translate("+t.offsets.x1+","+t.offsets.y1Main+")").attr("width",t.offsets.width).attr("height",t.offsets.y2Nav+30-t.offsets.y1Main).call(t.zoom).on("wheel",(function(){N.c.preventDefault()}))}),"keydown"),Nt.a.bind(n,(function(){t.svg.selectAll(".overlay").remove(),t.svg.selectAll(".brush").remove(),t._addBrush()}),"keyup")},Bt.prototype._createZoomFn=function(){return function(){var t=this,e=N.c.transform,n=this.zoomCoordinates[1]-this.zoomCoordinates[0],a=(n-n/e.k)/2,o=[Math.max(this.zoomCoordinates[0]+a,this.scales.xNav(0)),Math.min(this.zoomCoordinates[1]-a,this.scales.xNav.domain()[1])];o[1]-o[0]<500&&e.k>1||(this.zoomCoordinates=o,e.rescaleX(this.scales.xMain),this.axes.xMain=this.axes.xMain.scale(this.scales.xMain),this.svg.select(".xMain.axis").call(this.axes.xMain),this._drawBars(),this._drawZoomGenes(this.annotations),this.navGraph.select(".brush").call(this.brush.move,(function(){return t.zoomCoordinates.map(t.scales.xNav)})))}},Bt.prototype._drawMainNavElements=function(){this.mainGraph=this.svg.append("g").attr("class","main").attr("transform","translate("+this.offsets.x1+","+this.offsets.y1Main+")"),this.navGraph=this.svg.append("g").attr("class","nav").attr("transform","translate("+this.offsets.x1+","+this.offsets.y1Nav+")"),this.geneGraph=this.svg.append("g").attr("class","Gene").attr("transform","translate("+this.offsets.x1+","+this.offsets.y1Gene+")")},Bt.prototype._addClipMask=function(){this.svg.append("g").append("clipPath").attr("class","clipPath").attr("transform","translate("+this.offsets.x1+","+this.offsets.y1Main+")").attr("id","clip").append("rect").attr("id","cliprect").attr("width",this.offsets.width).attr("height",this.offsets.heightMain)};var Et,At,Gt,Pt=Bt,Vt=function(t){var e=t.hovered,n=t.width,a=t.height,o=t.mutType,i=t.showCounts,s=t.geneMap,r=t.t;if(!e)return null;var c={container:{position:"absolute",width:200,padding:"10px",borderRadius:10,zIndex:1e3,pointerEvents:"none",fontFamily:z.e.panel.fontFamily,fontSize:14,lineHeight:1,fontWeight:z.e.panel.fontWeight,color:z.e.panel.color,backgroundColor:z.e.panel.backgroundColor,wordWrap:"break-word",wordBreak:"break-word"}},l=document.getElementById("entropyYAxis").getBoundingClientRect(),h={x:e.x-l.left+15,y:e.y-l.top};h.x<.7*n?c.container.left=h.x:c.container.right=n-h.x,h.y<.5*a?c.container.top=h.y:c.container.bottom=a-h.y;var u=e.d.prot?"-"===s[e.d.prot].strand:null,f=e.d.prot?"aa"===o?u?s[e.d.prot].end-3*e.d.codon+3:s[e.d.prot].start+3*e.d.codon:u?s[e.d.prot].end-e.d.x:e.d.x-s[e.d.prot].start-1:null,p=e.d.prot&&"aa"!==o?Math.floor(f/3)+1:null;return y.a.createElement("div",{style:c.container},y.a.createElement("div",{className:"tooltip",style:z.e.tooltip},y.a.createElement("div",null,"aa"===o?r("Codon {{codon}} in protein {{protein}}",{codon:e.d.codon,protein:e.d.prot}):e.d.prot?"".concat(r("Nucleotide {{nuc}}",{nuc:e.d.x})," (").concat(r("Codon {{codon}} in protein {{protein}}",{codon:p,protein:e.d.prot}),")"):r("Nucleotide {{nuc}}",{nuc:e.d.x})),y.a.createElement("p",null),y.a.createElement("div",null,"aa"===o?r("Nuc positions {{a}} to {{b}}",{a:f-2,b:f}):""),y.a.createElement("p",null),y.a.createElement("div",null,null===u?"":r(u?"Negative strand":"Positive strand")),y.a.createElement("p",null),y.a.createElement("div",null,i?"".concat(r("Num mutations"),": ").concat(e.d.y):"".concat(r("entropy"),": ").concat(e.d.y)),y.a.createElement("div",{style:z.e.comment},r("Click to color tree & map"))))},Yt=n(162);n(220),n(558);function Lt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function Dt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Lt(Object(n),!0).forEach((function(e){d()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Lt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Rt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Ht=Object(g.b)((function(t){return{mutType:t.controls.mutType,bars:t.entropy.bars,annotations:t.entropy.annotations,geneMap:t.entropy.geneMap,geneLength:t.controls.geneLength,maxYVal:t.entropy.maxYVal,showCounts:t.entropy.showCounts,loaded:t.entropy.loaded,colorBy:t.controls.colorBy,zoomMin:t.controls.zoomMin,zoomMax:t.controls.zoomMax,defaultColorBy:t.controls.defaults.colorBy,shouldReRender:!1,panelLayout:t.controls.panelLayout,narrativeMode:t.narrative.display}}))((Gt=At=function(t){c()(a,t);var e,n=(e=a,function(){var t,n=f()(e);if(Rt()){var a=f()(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return h()(this,t)});function a(t){var e;return o()(this,a),(e=n.call(this,t)).state={hovered:!1,chart:!1},e}return s()(a,[{key:"onHover",value:function(t,e,n){this.setState({hovered:{d:t,type:".tip",x:e,y:n}})}},{key:"onLeave",value:function(){this.setState({hovered:!1})}},{key:"onClick",value:function(t){if(!this.props.narrativeMode){var e=function(t,e){return Object(Ot.c)("aa"===t?{gene:e.prot,positions:[e.codon]}:{positions:[e.x]})}(this.props.mutType,t);Object(Yt.a)("color-by-genotype"),this.props.dispatch(Object(_.a)(e)),this.setState({hovered:!1})}}},{key:"changeMutTypeCallback",value:function(t){t!==this.props.mutType&&(this.props.dispatch(Object(_.a)(this.props.defaultColorBy)),this.props.dispatch(Object(jt.a)(t)))}},{key:"aaNtSwitch",value:function(t){var e=this;return this.props.narrativeMode?null:y.a.createElement("div",{style:Dt({},z.l,{},t.aaNtSwitch)},y.a.createElement("button",{key:1,style:"aa"===this.props.mutType?z.n:z.m,onClick:function(){return e.changeMutTypeCallback("aa")}},y.a.createElement("span",{style:t.switchTitle}," ","AA"," ")),y.a.createElement("button",{key:2,style:"aa"!==this.props.mutType?z.n:z.m,onClick:function(){return e.changeMutTypeCallback("nuc")}},y.a.createElement("span",{style:t.switchTitle}," ","NT"," ")))}},{key:"entropyCountSwitch",value:function(t){var e=this,n=this.props.t;return this.props.narrativeMode?null:y.a.createElement("div",{style:Dt({},z.l,{},t.entropyCountSwitch)},y.a.createElement("button",{key:1,style:this.props.showCounts?z.m:z.n,onClick:function(){return e.props.dispatch(Object(jt.c)(!1))}},y.a.createElement("span",{style:t.switchTitle}," ",n("entropy")," ")),y.a.createElement("button",{key:2,style:this.props.showCounts?z.n:z.m,onClick:function(){return e.props.dispatch(Object(jt.c)(!0))}},y.a.createElement("span",{style:t.switchTitle}," ",n("events")," ")))}},{key:"setUp",value:function(t){var e=new Pt(this.d3entropy,t.annotations,t.geneMap,t.geneLength[Ct.I],{onHover:this.onHover.bind(this),onLeave:this.onLeave.bind(this),onClick:this.onClick.bind(this)});e.render(t),t.narrativeMode&&Object(b.a)(this.d3entropy).selectAll(".handle--custom").style("visibility","hidden"),this.setState({chart:e})}},{key:"componentDidMount",value:function(){this.props.loaded&&this.setUp(this.props)}},{key:"componentWillReceiveProps",value:function(t){if(t.loaded||this.setState({chart:!1}),this.state.chart){if(this.props.width!==t.width||this.props.height!==t.height)this.state.chart.render(t);else{var e={};if(this.props.zoomMax===t.zoomMax&&this.props.zoomMin===t.zoomMin||(e.zoomMax=t.zoomMax,e.zoomMin=t.zoomMin),this.props.bars!==t.bars&&(e.aa="aa"===t.mutType,e.newBars=t.bars,e.maxYVal=t.maxYVal),this.props.colorBy!==t.colorBy&&(Object(Ot.d)(this.props.colorBy)||Object(Ot.d)(t.colorBy)))if(Object(Ot.d)(t.colorBy)){var n=Object(Ot.a)(t.colorBy,t.geneLength);if(n.aa)e.gene=n.gene,e.start=t.geneMap[e.gene].start,e.end=t.geneMap[e.gene].end;else{var a,o,i=n.positions,s=this.state.chart.zoomCoordinates,r=this.state.chart.maxNt;if(i.length>1){var c=Math.min.apply(null,i),l=Math.max.apply(null,i);a=c-.05*(l-c),o=l+.05*(l-c)}else{var h=i[0],u=.05*r,f=h-u<=0?[0,h+u]:h+u>=r?[h-u,r]:[h-u,h+u];a=f[0],o=f[1]}a>s[0]-.4*r&&a<s[0]+.4*r&&o>s[1]-.4*r&&o<s[1]+.4*r&&i.every((function(t){return t>s[0]}))&&i.every((function(t){return t<s[1]}))||(e.gene=n.gene,e.start=a,e.end=o)}e.selected=Object(Ot.a)(t.colorBy,t.geneLength)}else e.clearSelected=!0;Object.keys(e).length&&this.state.chart.update(e)}this.props.narrativeMode!==t.narrativeMode&&(t.narrativeMode?Object(b.a)(this.d3entropy).selectAll(".handle--custom").style("visibility","hidden"):Object(b.a)(this.d3entropy).selectAll(".handle--custom").style("visibility","visible"))}else t.loaded&&this.setUp(t)}},{key:"render",value:function(){var t,e=this,n=this.props.t,a={switchContainer:{position:"absolute",marginTop:-5,paddingLeft:(t=this.props.width)-100},switchContainerWide:{position:"absolute",marginTop:-25,paddingLeft:t-185},switchTitle:{margin:5,position:"relative",top:-1},aaNtSwitch:{position:"absolute",right:5,top:0,zIndex:100},entropyCountSwitch:{position:"absolute",right:74,top:0,zIndex:100}};return y.a.createElement(k.a,{title:n("Diversity")},y.a.createElement(Vt,{hovered:this.state.hovered,width:this.props.width,height:this.props.height,mutType:this.props.mutType,showCounts:this.props.showCounts,geneMap:this.props.geneMap,t:n}),y.a.createElement("svg",{id:"d3entropyParent",style:{pointerEvents:"auto"},width:this.props.width,height:this.props.height},y.a.createElement("g",{ref:function(t){e.d3entropy=t},id:"d3entropy"})),this.aaNtSwitch(a),this.entropyCountSwitch(a))}}]),a}(y.a.Component),d()(At,"propTypes",{dispatch:x.a.func.isRequired,loaded:x.a.bool.isRequired,colorBy:x.a.string.isRequired,defaultColorBy:x.a.string.isRequired,mutType:x.a.string.isRequired}),Et=Gt))||Et,It=Object(M.c)()(Ht);e.default=It}}]);
//# sourceMappingURL=auspice.chunk.4.bundle.js.map